"Beta1vax_Cont"=beta1vaxsave[,4],
"Beta2vax_Cont"=beta2vaxsave[,4],
"Beta1deathRange_Ord"=beta1deathsave[,3]-beta1deathsave[,2],
"Beta1deathRange_Cont"=beta1deathsave[,6]-beta1deathsave[,5],
"Beta1vaxRange_Ord"=beta1vaxsave[,3]-beta1vaxsave[,5],
"Beta1vaxRange_Cont"=beta1vaxsave[,6]-beta1vaxsave[,5],
"Beta2deathRange_Ord"=beta2deathsave[,3]-beta2deathsave[,2],
"Beta2deathRange_Cont"=beta2deathsave[,6]-beta2deathsave[,5],
"Beta2vaxRange_Ord"=beta2vaxsave[,3]-beta2vaxsave[,5],
"Beta2vaxRange_Cont"=beta2vaxsave[,6]-beta2vaxsave[,5],
"fips"=fipscodes$fips)
df
df <- data.frame("County"=counties, "Population"=populations,
"ChangePoint_Ord"=tausave[,1],
"ChangePoint_Cont"=tausave[,4],
"ChangePointRange_Ord"=tausave[,3]-tausave[,2],
"ChangePointRange_Cont"=tausave[,6]-tausave[,5],
"Beta1death_Ord"=beta1deathsave[,1],
"Beta2death_Ord"=beta2deathsave[,1],
"Beta1vax_Ord"=beta1vaxsave[,1],
"Beta2vax_Ord"=beta2vaxsave[,1],
"Beta1death_Cont"=beta1deathsave[,4],
"Beta2death_Cont"=beta2deathsave[,4],
"Beta1vax_Cont"=beta1vaxsave[,4],
"Beta2vax_Cont"=beta2vaxsave[,4],
"Beta1deathRange_Ord"=beta1deathsave[,3]-beta1deathsave[,2],
"Beta1deathRange_Cont"=beta1deathsave[,6]-beta1deathsave[,5],
"Beta1vaxRange_Ord"=beta1vaxsave[,3]-beta1vaxsave[,5],
"Beta1vaxRange_Cont"=beta1vaxsave[,6]-beta1vaxsave[,5],
"Beta2deathRange_Ord"=beta2deathsave[,3]-beta2deathsave[,2],
"Beta2deathRange_Cont"=beta2deathsave[,6]-beta2deathsave[,5],
"Beta2vaxRange_Ord"=beta2vaxsave[,3]-beta2vaxsave[,5],
"Beta2vaxRange_Cont"=beta2vaxsave[,6]-beta2vaxsave[,5],
"Gamma3_Ord" = gamma3save[,1],
"Gamma4_Ord" = gamma4save[,1],
"Gamma3Range_Ord" = gamma3save[,3] - gamma3save[,2],
"Gamma4Range_Ord" = gamma4save[,3] - gamma4save[,2],
"fips"=fipscodes$fips)
df
gamma3save
df <- data.frame("County"=counties, "Population"=populations,
"ChangePoint_Ord"=tausave[,1],
"ChangePoint_Cont"=tausave[,4],
"ChangePointRange_Ord"=tausave[,3]-tausave[,2],
"ChangePointRange_Cont"=tausave[,6]-tausave[,5],
"Beta1death_Ord"=beta1deathsave[,1],
"Beta2death_Ord"=beta2deathsave[,1],
"Beta1vax_Ord"=beta1vaxsave[,1],
"Beta2vax_Ord"=beta2vaxsave[,1],
"Beta1death_Cont"=beta1deathsave[,4],
"Beta2death_Cont"=beta2deathsave[,4],
"Beta1vax_Cont"=beta1vaxsave[,4],
"Beta2vax_Cont"=beta2vaxsave[,4],
"Beta1deathRange_Ord"=beta1deathsave[,3]-beta1deathsave[,2],
"Beta1deathRange_Cont"=beta1deathsave[,6]-beta1deathsave[,5],
"Beta1vaxRange_Ord"=beta1vaxsave[,3]-beta1vaxsave[,5],
"Beta1vaxRange_Cont"=beta1vaxsave[,6]-beta1vaxsave[,5],
"Beta2deathRange_Ord"=beta2deathsave[,3]-beta2deathsave[,2],
"Beta2deathRange_Cont"=beta2deathsave[,6]-beta2deathsave[,5],
"Beta2vaxRange_Ord"=beta2vaxsave[,3]-beta2vaxsave[,5],
"Beta2vaxRange_Cont"=beta2vaxsave[,6]-beta2vaxsave[,5],
"Gamma3_Ord" = gamma3save[,1],
"Gamma4_Ord" = gamma4save[,1],
"fips"=fipscodes$fips)
gamma3save
load("/Users/adamiser810/Desktop/Change-point-models/Individual_County_Analysis/AlbanyCounty.Rdata")
mcmc.outOrd$summary
load("/Users/adamiser810/Desktop/Change-point-models/CurrentModel.Rdata")
df <- data.frame("County"=counties, "Population"=populations,
"ChangePoint_Ord"=tausave[,1],
"ChangePoint_Cont"=tausave[,4],
"ChangePointRange_Ord"=tausave[,3]-tausave[,2],
"ChangePointRange_Cont"=tausave[,6]-tausave[,5],
"Beta1death_Ord"=beta1deathsave[,1],
"Beta2death_Ord"=beta2deathsave[,1],
"Beta1vax_Ord"=beta1vaxsave[,1],
"Beta2vax_Ord"=beta2vaxsave[,1],
"Beta1death_Cont"=beta1deathsave[,4],
"Beta2death_Cont"=beta2deathsave[,4],
"Beta1vax_Cont"=beta1vaxsave[,4],
"Beta2vax_Cont"=beta2vaxsave[,4],
"Beta1deathRange_Ord"=beta1deathsave[,3]-beta1deathsave[,2],
"Beta1deathRange_Cont"=beta1deathsave[,6]-beta1deathsave[,5],
"Beta1vaxRange_Ord"=beta1vaxsave[,3]-beta1vaxsave[,5],
"Beta1vaxRange_Cont"=beta1vaxsave[,6]-beta1vaxsave[,5],
"Beta2deathRange_Ord"=beta2deathsave[,3]-beta2deathsave[,2],
"Beta2deathRange_Cont"=beta2deathsave[,6]-beta2deathsave[,5],
"Beta2vaxRange_Ord"=beta2vaxsave[,3]-beta2vaxsave[,5],
"Beta2vaxRange_Cont"=beta2vaxsave[,6]-beta2vaxsave[,5],
"Gamma3_Ord" = gamma3save[,1],
"Gamma4_Ord" = gamma4save[,1],
"fips"=fipscodes$fips)
# Map of Gammas
plot_usmap(data = df, values = "Gamma3_Ord", include = "New York") + scale_fill_continuous(name = "Gamma3_Ord") +
theme(legend.position = 'right') +
ggtile("Gamma 3")
library(ggplot2)
library(usmap)
library(gridExtra)
# Map of Gammas
plot_usmap(data = df, values = "Gamma3_Ord", include = "New York") + scale_fill_continuous(name = "Gamma3_Ord") +
theme(legend.position = 'right') +
ggtile("Gamma 3")
library(ggplot2)
# Map of Gammas
plot_usmap(data = df, values = "Gamma3_Ord", include = "New York") + scale_fill_continuous(name = "Gamma3_Ord") +
theme(legend.position = 'right') +
ggtitle("Gamma 3")
plot_usmap(data = df, values = "Gamma4_Ord", include = "New York") + scale_fill_continuous(name = "Gamma4_Ord") +
theme(legend.position = 'right') +
ggtitle("Gamma 4")
gamma3_nyplot <- plot_usmap(data = df, values = "Gamma3_Ord", include = "New York") + scale_fill_continuous(name = "Gamma3_Ord") +
theme(legend.position = 'right') +
ggtitle("Gamma 3")
gamma4_nyplot <- plot_usmap(data = df, values = "Gamma4_Ord", include = "New York") + scale_fill_continuous(name = "Gamma4_Ord") +
theme(legend.position = 'right') +
ggtitle("Gamma 4")
grid.arrange(gamma3_nyplot, gamma4_nyplot, ncol = 2)
view(df)
df[c(1,4,8,14,15,22,24,26:28,30,
32:38,40:42,45:47,52,54:60),
"Urban/Rural"] <- "Urban"
df
ifelse(df$Urban/Rural == "Urban",
df$Urban/Rural = "Urban",
df$Urban/Rural = "Rural")
df <- data.frame("County"=counties, "Population"=populations,
"ChangePoint_Ord"=tausave[,1],
"ChangePoint_Cont"=tausave[,4],
"ChangePointRange_Ord"=tausave[,3]-tausave[,2],
"ChangePointRange_Cont"=tausave[,6]-tausave[,5],
"Beta1death_Ord"=beta1deathsave[,1],
"Beta2death_Ord"=beta2deathsave[,1],
"Beta1vax_Ord"=beta1vaxsave[,1],
"Beta2vax_Ord"=beta2vaxsave[,1],
"Beta1death_Cont"=beta1deathsave[,4],
"Beta2death_Cont"=beta2deathsave[,4],
"Beta1vax_Cont"=beta1vaxsave[,4],
"Beta2vax_Cont"=beta2vaxsave[,4],
"Beta1deathRange_Ord"=beta1deathsave[,3]-beta1deathsave[,2],
"Beta1deathRange_Cont"=beta1deathsave[,6]-beta1deathsave[,5],
"Beta1vaxRange_Ord"=beta1vaxsave[,3]-beta1vaxsave[,5],
"Beta1vaxRange_Cont"=beta1vaxsave[,6]-beta1vaxsave[,5],
"Beta2deathRange_Ord"=beta2deathsave[,3]-beta2deathsave[,2],
"Beta2deathRange_Cont"=beta2deathsave[,6]-beta2deathsave[,5],
"Beta2vaxRange_Ord"=beta2vaxsave[,3]-beta2vaxsave[,5],
"Beta2vaxRange_Cont"=beta2vaxsave[,6]-beta2vaxsave[,5],
"Gamma3_Ord" = gamma3save[,1],
"Gamma4_Ord" = gamma4save[,1],
"fips"=fipscodes$fips)
df[c(1,4,8,14,15,22,24,26:28,30,
32:38,40:42,45:47,52,54:60),
"Urban_Rural"] <- "Urban"
ifelse(df$Urban_Rural == "Urban",
df$Urban_Rural = "Urban",
df$Urban_Rural = "Rural")
df[c(2:3,5:7,9:13,16:21,23,25,29,
31,39,43:44,48:51,53,61:62),
"Urban_Rural"] <- "Rural"
view(df)
mean(df[df$Urban_Rural == "Urban",]$ChangePoint_Ord)
df[df$Urban_Rural == "Urban",]
mean(df[df$Urban_Rural == "Urban",]$ChangePoint_Ord)
mean(df[df$Urban_Rural == "Rural",]$ChangePoint_Ord)
mean(df[df$Urban_Rural == "Urban",]$ChangePoint_Ord)
mean(df[df$Urban_Rural == "Rural",]$ChangePoint_Ord)
mean(df[df$Urban_Rural == "Urban",]$ChangePointRange_Ord)
mean(df[df$Urban_Rural == "Rural",]$ChangePointRange_Ord)
# Relationship between population and change point
plot(df$ChangePoint_Ord, log(df$Population),
ylab = "log Population",
xlab = "Change Point (Ordinal Response)",
main = "Population vs. Change Point")
plot(df[df$Urban_Rural == "Urban",]$ChangePoint_Ord, log(df$Population))
urban_df <- df[df$Urban_Rural == "Urban",]
rural_df <- df[df$Urban_Rural == "Rural",]
plot(urban_df$ChangePoint_Ord, log(urban_df$Population))
plot(rural_df$ChangePoint_Ord, log(rural_df$Population)
plot(rural_df$ChangePoint_Ord, log(rural_df$Population))
plot(rural_df$ChangePoint_Ord, log(rural_df$Population))
plot(urban_df$ChangePoint_Ord, log(urban_df$Population))
plot(rural_df$ChangePoint_Ord, log(rural_df$Population))
plot(urban_df$ChangePoint_Ord, log(urban_df$Population))
par(mfrow = c(1, 2))
par(mfrow = c(1, 2))
plot(urban_df$ChangePoint_Ord, log(urban_df$Population))
plot(rural_df$ChangePoint_Ord, log(rural_df$Population))
par(mfrow = c(1, 2))
plot(urban_df$ChangePoint_Ord, log(urban_df$Population),
ylab = "log Population",
xlab = "Change Point (Ordinal)",
main = "Urban: Population vs Change Point ")
plot(rural_df$ChangePoint_Ord, log(rural_df$Population),
ylab = "log Population",
xlab = "Change Point (Ordinal)",
main = "Rural: Population vs Change Point ")
gamma3_nyplot <- plot_usmap(data = df, values = "Gamma3_Ord", include = "New York") + scale_fill_continuous(name = "Gamma3_Ord") +
theme(legend.position = 'right') +
ggtitle("Gamma 3")
gamma4_nyplot <- plot_usmap(data = df, values = "Gamma4_Ord", include = "New York") + scale_fill_continuous(name = "Gamma4_Ord") +
theme(legend.position = 'right') +
ggtitle("Gamma 4")
grid.arrange(gamma3_nyplot, gamma4_nyplot, ncol = 2)
library(tidyverse)
library(ggplot2)
library(usmap)
library(gridExtra)
dat <- read.csv("currentjoineddata.csv")
counties <- unique(dat$Recip_County)
n.counties <- length(counties)
populations <- unique(dat$population)
load('CurrentModel.Rdata')
fipscodes <- read.table(header=F, sep=" ", text="
36001        Albany County
36003        Allegany County
36005        Bronx County
36007        Broome County
36009        Cattaraugus County
36011        Cayuga County
36013        Chautauqua County
36015        Chemung County
36017        Chenango County
36019        Clinton County
36021        Columbia County
36023        Cortland County
36025        Delaware County
36027        Dutchess County
36029        Erie County
36031        Essex County
36033        Franklin County
36035        Fulton County
36037        Genesee County
36039        Greene County
36041        Hamilton County
36043        Herkimer County
36045        Jefferson County
36047        Kings County
36049        Lewis County
36051        Livingston County
36053        Madison County
36055        Monroe County
36057        Montgomery County
36059        Nassau County
36061        NewYork County
36063        Niagara County
36065        Oneida County
36067        Onondaga County
36069        Ontario County
36071        Orange County
36073        Orleans County
36075        Oswego County
36077        Otsego County
36079        Putnam County
36081        Queens County
36083        Rensselaer County
36085        Richmond County
36087        Rockland County
36089        StLawrence County
36091        Saratoga County
36093        Schenectady County
36095        Schoharie County
36097        Schuyler County
36099        Seneca County
36101        Steuben County
36103        Suffolk County
36105        Sullivan County
36107        Tioga County
36109        Tompkins County
36111        Ulster County
36113        Warren County
36115        Washington County
36117        Wayne County
36119        Westchester County
36121        Wyoming County
36123        Yates County
")
fipscodes <- fipscodes[,c(5,13)]
names(fipscodes)=c("fips", "county")
fipscodes[45:50,] <- fipscodes[c(46:50,45),]
df <- data.frame("County"=counties, "Population"=populations,
"ChangePoint_Ord"=tausave[,1],
"ChangePoint_Cont"=tausave[,4],
"ChangePointRange_Ord"=tausave[,3]-tausave[,2],
"ChangePointRange_Cont"=tausave[,6]-tausave[,5],
"Beta1death_Ord"=beta1deathsave[,1],
"Beta2death_Ord"=beta2deathsave[,1],
"Beta1vax_Ord"=beta1vaxsave[,1],
"Beta2vax_Ord"=beta2vaxsave[,1],
"Beta1death_Cont"=beta1deathsave[,4],
"Beta2death_Cont"=beta2deathsave[,4],
"Beta1vax_Cont"=beta1vaxsave[,4],
"Beta2vax_Cont"=beta2vaxsave[,4],
"Beta1deathRange_Ord"=beta1deathsave[,3]-beta1deathsave[,2],
"Beta1deathRange_Cont"=beta1deathsave[,6]-beta1deathsave[,5],
"Beta1vaxRange_Ord"=beta1vaxsave[,3]-beta1vaxsave[,5],
"Beta1vaxRange_Cont"=beta1vaxsave[,6]-beta1vaxsave[,5],
"Beta2deathRange_Ord"=beta2deathsave[,3]-beta2deathsave[,2],
"Beta2deathRange_Cont"=beta2deathsave[,6]-beta2deathsave[,5],
"Beta2vaxRange_Ord"=beta2vaxsave[,3]-beta2vaxsave[,5],
"Beta2vaxRange_Cont"=beta2vaxsave[,6]-beta2vaxsave[,5],
"Gamma3_Ord" = gamma3save[,1],
"Gamma4_Ord" = gamma4save[,1],
"fips"=fipscodes$fips)
df[c(1,4,8,14,15,22,24,26:28,30,
32:38,40:42,45:47,52,54:60),
"Urban_Rural"] <- "Urban"
df[c(2:3,5:7,9:13,16:21,23,25,29,
31,39,43:44,48:51,53,61:62),
"Urban_Rural"] <- "Rural"
urban_df <- df[df$Urban_Rural == "Urban",]
rural_df <- df[df$Urban_Rural == "Rural",]
par(mfrow = c(1, 2))
plot(urban_df$ChangePoint_Ord, log(urban_df$Population),
ylab = "log Population",
xlab = "Change Point (Ordinal)",
main = "Urban: Population vs Change Point ")
plot(rural_df$ChangePoint_Ord, log(rural_df$Population),
ylab = "log Population",
xlab = "Change Point (Ordinal)",
main = "Rural: Population vs Change Point ")
view(df)
dat <- read.csv("currentjoineddata.csv")
counties <- unique(dat$Recip_County)
n.counties <- length(counties)
populations <- unique(dat$population)
n.weeks <- length(dat)
names(dat)
dat %>%
group_by(Recip_County) %>%
summarize(Mean = mean(population))
library(tidyverse)
length(dat %>%
group_by(Recip_County) %>%
summarize(Mean = mean(population)))
dim(dat %>%
group_by(Recip_County) %>%
summarize(Mean = mean(population)))[1]
thiscounty <- counties[1]
this <- dat %>%
subset(Recip_County==thiscounty)
this
dim(this <- dat %>%
subset(Recip_County==thiscounty))[1]
int <- 30
for (i in 1:n.weeks-int) {
print(i)
}
n.weeks <- dim(this <- dat %>%
subset(Recip_County==thiscounty))[1]
for (i in 1:n.weeks-int) {
print(i)
}
for (i in 1:(n.weeks-int)) {
print(i)
}
this <- dat %>%
subset(Recip_County==thiscounty)
cat1 <- sum(this[lower:upper, this$category == 1])
cat1 <- sum(this[this$category == 1,]$category)
cat1
cat2 <- sum(this[this$category == 2,]$category)
cat2
cat2 <- sum(this[this$category == 2,])
this[this$category == 1]
window <- this[lower:upper,]
this[this$category == 1,]
lower <- i
upper <- i + 30
window <- this[lower:upper,]
med_logdeath <- median(window$prev_log_new_death)
med_vax <- median(window$total_first_dose)
int <- 30
for (i in 1:(n.weeks-int)) {
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- length(window[window$category == 1,]) / int
cat2[i] <- length(window[window$category == 2,]) / int
cat3[i] <- length(window[window$category == 3,]) / int
cat4[i] <- length(window[window$category == 4,]) / int
logdeath[i] <- median(window$prev_log_new_death)
vax[i] <- median(window$total_first_dose)
}
cat1
length(window[window$category == 1,])
i <- 27
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
window
length(window[window$category == 1,])
length(window[window$category == 2,])
window[window$category == 1,]
window[window$category == 1,]$category
window[window$category == 1]$category
window[window$category == 1]
window$category
window[window$category == "1",]
this[this$category == 1,]
window <- this[lower:upper,]
window
view(window)
attributes(window)
window$category == 2
sum(window$category == 2)
int <- 30
for (i in 1:(n.weeks-int)) {
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- median(window$prev_log_new_death)
vax[i] <- median(window$total_first_dose)
}
cat1
window
sum(window$category == 1)
sum(window$category == 4)
cat4
cat3
cat2
logdeath
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
for (i in 1:(n.weeks-int)) {
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- median(window$prev_log_new_death)
vax[i] <- median(window$total_first_dose)
}
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- median(window$prev_log_new_death)
vax[i] <- median(window$total_first_dose)
}
cat1
cat2
plot(logdeath, cat1)
plot(logdeath, cat2)
plot(logdeath, cat3)
plot(logdeath, cat4)
par(mfrow = c(2, 2))
plot(logdeath, cat1)
plot(logdeath, cat2)
plot(logdeath, cat3)
plot(logdeath, cat4)
plot(vax, cat1)
plot(vax, cat2)
plot(vax, cat3)
plot(vax, cat4)
plot(1:92, cat1)
plot(1:92, cat2)
plot(1:92, cat3)
plot(1:92, cat4)
