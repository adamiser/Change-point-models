line_logdeath <- ggplot(data = df, mapping = aes(x = Logdeath, y = Prob,
group = factor(Cat), color = factor(Cat))) +
geom_line() +
ggtitle(title_logdeath) +
labs(color = "Category", group = "Category")
line_vax
thiscounty <- counties[31]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
title_vax <- paste(thiscounty, "- Percent Vaccinated vs Ordinal Probability")
title_death <- paste(thiscounty, "- Death vs Ordinal Probability")
title_logdeath <- paste(thiscounty, "- Log Prev Death vs Ordinal Probability")
county <- gsub(" ", "", thiscounty)
point_vax <- ggplot(data = df, mapping = aes(x = Vax, y = Prob,
group = factor(Cat), color = factor(Cat))) +
geom_point() +
ggtitle(title_vax) +
labs(color = "Category", group = "Category")
line_vax <- ggplot(data = df, mapping = aes(x = Vax, y = Prob,
group = factor(Cat), color = factor(Cat))) +
geom_line(size = 2) +
ggtitle(title_vax) +
labs(color = "Category", group = "Category") +
xlab("First Dose Vaccination - Percent of Population") +
ylab("Probability")
point_death <- ggplot(data = df, mapping = aes(x = Death, y = Prob,
group = factor(Cat), color = factor(Cat))) +
geom_point() +
ggtitle(title_death) +
labs(color = "Category", group = "Category")
line_death <- ggplot(data = df, mapping = aes(x = Death, y = Prob,
group = factor(Cat), color = factor(Cat))) +
geom_line() +
ggtitle(title_death) +
labs(color = "Category", group = "Category")
point_logdeath <- ggplot(data = df, mapping = aes(x = Logdeath, y = Prob,
group = factor(Cat), color = factor(Cat))) +
geom_point() +
ggtitle(title_logdeath) +
labs(color = "Category", group = "Category")
line_logdeath <- ggplot(data = df, mapping = aes(x = Logdeath, y = Prob,
group = factor(Cat), color = factor(Cat))) +
geom_line() +
ggtitle(title_logdeath) +
labs(color = "Category", group = "Category")
line_vax
single_category <- rep(0, (n.weeks-int))
for (i in 1:(n.weeks-int)) {
single_category[i] <- mean(sample(categories, size = 1, replace = TRUE, prob = c(cat1[i], cat2[i], cat3[i], cat4[i])))
}
categories <- 1:4
for (i in 1:(n.weeks-int)) {
single_category[i] <- mean(sample(categories, size = 1, replace = TRUE, prob = c(cat1[i], cat2[i], cat3[i], cat4[i])))
}
plot(1:(n.weeks-int), single_category)
categories <- 1:4
pred_category <- rep(0, n.weeks-int)
for (i in 1:(n.weeks-int)) {
pred_category[i] <- mean(sample(categories, size = 1000, replace = TRUE, prob = c(cat1[i], cat2[i], cat3[i], cat4[i])))
}
data <- list()
dat <- read.csv("currentjoineddata.csv")
counties <- unique(dat$Recip_County)
n.counties <- length(counties)
populations <- unique(dat$population)
thiscounty <- counties[31]
n.weeks <- dim(this <- dat %>%
subset(Recip_County==thiscounty))[1]
int <- 30
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
death <- rep(0, n.weeks - int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
data <- list()
iter <- 1
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
data[[iter]] <- df
++iter
}
}
data
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
data[[iter]] <- df
iter <- iter + 1
}
}
data
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
data[[iter]] <- df
iter <- iter + 1
}
rm(data)
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
data[[iter]] <- df
iter <- iter + 1
}
data <- list()
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
data[[iter]] <- df
iter <- iter + 1
}
data
data[[1]]
data[[2]]
iter <- 1
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
data[[iter]] <- df
iter <- iter + 1
}
rm(data)
data <- list()
iter <- 1
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
data[[iter]] <- df
iter <- iter + 1
}
logdeath_list <- list()
logdeath_list <- list()
iter <- 1
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
logdeath_list[[iter]] <- logdeath
data[[iter]] <- df
iter <- iter + 1
}
plot(logdeath[[1]], pred_category,
xlab = "Prev_new_log_death",
ylab = "Average Predicted Category",
main = "Average Predicted Category - Sampled Data")
pred_category <- rep(0, n.weeks-int)
for (i in 1:(n.weeks-int)) {
pred_category[i] <- mean(sample(categories, size = 1000, replace = TRUE, prob = c(cat1[i], cat2[i], cat3[i], cat4[i])))
}
length(logdeath[[1]])
logdeath[[1]]
logdeath
logdeath_list
plot(logdeath_list[[1]], pred_category,
xlab = "Prev_new_log_death",
ylab = "Average Predicted Category",
main = "Average Predicted Category - Sampled Data")
points(logdeath_list[[2]])
plot(logdeath_list[[1]], pred_category,
xlab = "Prev_new_log_death",
ylab = "Average Predicted Category",
main = "Average Predicted Category - Sampled Data")
points(logdeath_list[[2]])
plot(logdeath_list[[1]], pred_category,
xlab = "Prev_new_log_death",
ylab = "Average Predicted Category",
main = "Average Predicted Category - Sampled Data")
points(logdeath_list[[2]], pred_category)
plot(logdeath_list[[1]], pred_category,
xlab = "Prev_new_log_death",
ylab = "Average Predicted Category",
main = "Average Predicted Category - Sampled Data")
lines(logdeath_list[[2]], pred_category)
plot(logdeath_list[[1]], pred_category)
plot(logdeath_list[[2]], pred_category)
plot(logdeath_list[[1]], pred_category,
xlab = "Prev_new_log_death",
ylab = "Average Predicted Category",
main = "Average Predicted Category - Sampled Data")
points(logdeath_list[[2]], pred_category)
ggplot() +
geom_line(mapping = aes(x = logdeath_list[[1]], y = pred_category))
ggplot() +
geom_point(mapping = aes(x = logdeath_list[[1]], y = pred_category))
ggplot() +
geom_point(mapping = aes(x = logdeath_list[[1]], y = pred_category)) +
geom_point(mapping = aes(x = logdeath_list[[2]], y = pred_category))
ggplot() +
geom_point(mapping = aes(x = logdeath_list[[1]], y = pred_category)) +
geom_point(mapping = aes(x = logdeath_list[[2]], y = pred_category)) +
geom_point(mapping = aes(x = logdeath_list[[3]], y = pred_category))
rep("Erie", 92)
logdeath_list[[3]])
df <- data.frame("County" <- c(rep("Allegany", 92)), rep("Erie", 92), rep("NY", 92),
"Logdeath" <- c(logdeath_list[[1]], logdeath_list[[2]],
logdeath_list[[3]]))
df
df <- data.frame("County" = c(rep("Allegany", 92)), rep("Erie", 92), rep("NY", 92)),
df <- data.frame("County" = c(rep("Allegany", 92), rep("Erie", 92), rep("NY", 92)),
"Logdeath" = c(logdeath_list[[1]], logdeath_list[[2]],
logdeath_list[[3]]))
df
data[[1]]$Cat
cat1_list <- list()
cat2_list <- list()
cat3_list <- list()
cat4_list <- list()
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
logdeath_list[[iter]] <- logdeath
cat1_list[[iter]] <- cat1
cat2_list[[iter]] <- cat2
cat3_list[[iter]] <- cat3
cat4_list[[iter]] <- cat4
data[[iter]] <- df
iter <- iter + 1
}
dat <- read.csv("currentjoineddata.csv")
counties <- unique(dat$Recip_County)
n.counties <- length(counties)
populations <- unique(dat$population)
thiscounty <- counties[31]
n.weeks <- dim(this <- dat %>%
subset(Recip_County==thiscounty))[1]
int <- 30
logdeath <- rep(0, n.weeks-int)
vax <- rep(0, n.weeks-int)
death <- rep(0, n.weeks - int)
cat1 <- rep(0, n.weeks-int)
cat2 <- rep(0, n.weeks-int)
cat3 <- rep(0, n.weeks-int)
cat4 <- rep(0, n.weeks-int)
data <- list()
logdeath_list <- list()
cat1_list <- list()
cat2_list <- list()
cat3_list <- list()
cat4_list <- list()
iter <- 1
for (kk in c(2, 15, 31)) {
thiscounty <- counties[kk]
for (i in 1:(n.weeks-int)) {
this <- dat %>%
subset(Recip_County==thiscounty)
lower <- i
upper <- i + 30
window <- this[lower:upper,]
cat1[i] <- sum(window$category == 1) / int
cat2[i] <- sum(window$category == 2)  / int
cat3[i] <- sum(window$category == 3)  / int
cat4[i] <- sum(window$category == 4)  / int
logdeath[i] <- mean(window$prev_log_new_death)
vax[i] <- median(window$Administered_Dose1_Pop_Pct.x)
death[i] <- median(window$death)
}
df <- data.frame("Prob" = c(cat1, cat2, cat3, cat4),
"Cat" = c(rep(1, n.weeks-int), rep(2, n.weeks-int), rep(3, n.weeks-int), rep(4, n.weeks-int)),
"Vax" = c(vax, vax, vax, vax),
"Death" = c(death, death, death, death),
"Logdeath" = c(logdeath, logdeath, logdeath, logdeath))
logdeath_list[[iter]] <- logdeath
cat1_list[[iter]] <- cat1
cat2_list[[iter]] <- cat2
cat3_list[[iter]] <- cat3
cat4_list[[iter]] <- cat4
data[[iter]] <- df
iter <- iter + 1
}
categories <- 1:4
pred_category <- list()
for (kk in 1:3) {
for (i in 1:(n.weeks-int)) {
pred_category[[kk]] <- mean(sample(categories, size = 1000,
replace = TRUE,
prob = c(cat1_list[[kk]], cat2_list[[kk]],
cat3_list[[kk]], cat4_list[[kk]])))
}
}
cat1_list[[1]]
cat2_list[[1]]
cat3_list[[1]]
cat_list[[4]]
cat4_list[[1]]
categories <- 1:4
pred_category <- list()
for (kk in 1:3) {
for (i in 1:(n.weeks-int)) {
pred_category[[kk]][i] <- mean(sample(categories, size = 1000,
replace = TRUE,
prob = c(cat1_list[[kk]], cat2_list[[kk]],
cat3_list[[kk]], cat4_list[[kk]])))
}
}
pred_category <- list(rep(0, (n.weeks-int)),
rep(0, (n.weeks-int)),
rep(0, (n.weeks-int)))
for (kk in 1:3) {
for (i in 1:(n.weeks-int)) {
pred_category[[kk]][i] <- mean(sample(categories, size = 1000,
replace = TRUE,
prob = c(cat1_list[[kk]], cat2_list[[kk]],
cat3_list[[kk]], cat4_list[[kk]])))
}
}
pred_category <- list()
for (kk in 1:3) {
for (i in 1:(n.weeks-int)) {
pred_category[[kk]][i] <- mean(sample(categories, size = 1000,
replace = TRUE,
prob = c(cat1_list[[kk]][i], cat2_list[[kk]][i],
cat3_list[[kk]][i], cat4_list[[kk][i]])))
for (kk in 1:3) {
categories <- 1:4
pred_category <- list()
for (kk in 1:3) {
for (i in 1:(n.weeks-int)) {
pred_category[[kk]][i] <- mean(sample(categories, size = 1000,
replace = TRUE,
prob = c(cat1_list[[kk]][i], cat2_list[[kk]][i],
cat3_list[[kk]][i], cat4_list[[kk]][i])))
}
}
pred_category
for (kk in 1:3) {
for (i in 1:(n.weeks-int)) {
pred_category[[kk]][i] <- mean(sample(categories, size = 1000,
replace = TRUE,
prob = c(cat1_list[[kk]][i], cat2_list[[kk]][i],
cat3_list[[kk]][i], cat4_list[[kk]][i])))
}
}
categories <- 1:4
